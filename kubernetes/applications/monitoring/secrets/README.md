# Monitoring Secrets

This directory contains sealed secrets for the monitoring stack (Grafana, Prometheus, Alertmanager).

## Contents

Sealed secrets in this directory are automatically generated by the `seal-secrets` playbook from the `secrets.yml` file in the project root.

**DO NOT manually edit sealed secret files** - they will be overwritten on the next run of `make seal-secrets`.

## Secrets

- `grafana-admin-sealed.yaml` - Grafana admin credentials
  - Used by: kube-prometheus-stack Helm chart
  - Contains: `admin-user`, `admin-password`

## Applying Secrets

Secrets are automatically applied when using ArgoCD:
```bash
kubectl apply -f kubernetes/applications/monitoring/application.yaml
```

Or apply manually:
```bash
kubectl apply -f grafana-admin-sealed.yaml
```

## Verifying Secrets

Check if the sealed secret was decrypted:
```bash
# Check the SealedSecret resource
kubectl get sealedsecret grafana-admin-secret -n monitoring

# Check the decrypted Secret (created by sealed-secrets controller)
kubectl get secret grafana-admin-secret -n monitoring

# View secret data (base64 encoded)
kubectl get secret grafana-admin-secret -n monitoring -o yaml
```

## Updating Secrets

1. Edit `secrets.yml` in the project root
2. Run `make seal-secrets`
3. The sealed secret will be regenerated and committed to git
4. Apply via ArgoCD sync or kubectl

## Security Notes

- **Sealed secrets are safe to commit to git** - they can only be decrypted by the sealed-secrets controller in your cluster
- The original `secrets.yml` file is **gitignored** and should **NEVER** be committed
- Backup the sealed-secrets encryption key securely (see kubernetes/services/sealed-secrets/README.md)
