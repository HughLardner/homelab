---
# Homepage Widgets ConfigMap
# Contains info widgets for the dashboard header
# Including: datetime, search, kubernetes stats, longhorn storage, proxmox
apiVersion: v1
kind: ConfigMap
metadata:
  name: homepage-widgets
  namespace: {{ .Release.Namespace }}
  labels:
    app.kubernetes.io/name: homepage
    app.kubernetes.io/component: config
data:
  widgets.yaml: |
    - datetime:
        text_size: xl
        format:
          dateStyle: long
          timeStyle: short
    - search:
        provider: google
        target: _blank
    - kubernetes:
        cluster:
          show: true
          cpu: true
          memory: true
          showLabel: true
          label: "{{ .Values.cluster.name | default "homelab" }}"
        nodes:
          show: true
          cpu: true
          memory: true
          showLabel: true
    # Longhorn widget disabled - requires longhorn.yaml which helm chart doesn't create
    # Proxmox widget disabled - requires proxmox.yaml which helm chart doesn't create
    # TODO: Add custom ConfigMaps for these widgets
    {{- if .Values.services.homepage.openweather_location }}
    - openweathermap:
        label: {{ .Values.services.homepage.openweather_location | default "Weather" }}
        latitude: {{ .Values.services.homepage.openweather_lat | default "40.7128" }}
        longitude: {{ .Values.services.homepage.openweather_lon | default "-74.0060" }}
        units: imperial
        apiKey: {{`{{HOMEPAGE_VAR_OPENWEATHER_API_KEY}}`}}
    {{- end }}

