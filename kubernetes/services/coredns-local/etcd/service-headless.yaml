---
# etcd Headless Service
# Provides stable DNS identities for StatefulSet pods
#
# DNS Names:
# - coredns-etcd-0.coredns-etcd.coredns-local.svc.cluster.local
# - coredns-etcd-1.coredns-etcd.coredns-local.svc.cluster.local
# - coredns-etcd-2.coredns-etcd.coredns-local.svc.cluster.local

apiVersion: v1
kind: Service
metadata:
  name: coredns-etcd
  namespace: coredns-local
  labels:
    app: coredns-etcd
    app.kubernetes.io/name: etcd
    app.kubernetes.io/component: database
spec:
  clusterIP: None  # Headless service
  publishNotReadyAddresses: true  # Allow DNS before pods are ready
  selector:
    app: coredns-etcd
  ports:
  - port: 2379
    targetPort: 2379
    protocol: TCP
    name: client
  - port: 2380
    targetPort: 2380
    protocol: TCP
    name: peer
