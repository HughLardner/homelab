---
# CoreDNS LoadBalancer Service
# Exposes CoreDNS on static IP 192.168.10.150 for local network DNS queries
#
# Configure this IP as primary DNS in your router/DHCP settings:
#   Primary DNS: 192.168.10.150 (CoreDNS on cluster)
#   Secondary DNS: 1.1.1.1 (Cloudflare fallback)

apiVersion: v1
kind: Service
metadata:
  name: coredns
  namespace: coredns-local
  labels:
    app: coredns
    app.kubernetes.io/name: coredns
    app.kubernetes.io/component: dns-server
  annotations:
    metallb.universe.tf/loadBalancerIPs: 192.168.10.150
    external-dns.alpha.kubernetes.io/hostname: dns.silverseekers.org
    external-dns.alpha.kubernetes.io/ttl: "300"
spec:
  type: LoadBalancer
  selector:
    app: coredns
  ports:
  - port: 53
    targetPort: 53
    protocol: UDP
    name: dns
  - port: 53
    targetPort: 53
    protocol: TCP
    name: dns-tcp
  - port: 9153
    targetPort: 9153
    protocol: TCP
    name: metrics
  sessionAffinity: None
  externalTrafficPolicy: Cluster
