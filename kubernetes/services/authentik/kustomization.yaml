---
# Kustomization for Authentik additional resources
# Note: Main installation is via Helm chart
# Note: IngressRoute and Middleware are applied separately by Ansible (with Jinja2 templating)
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: authentik

# Generate ConfigMap from blueprint files
# These are mounted into the Authentik worker for declarative configuration
configMapGenerator:
  - name: authentik-blueprints
    files:
      - blueprints/00-groups.yaml
      - blueprints/10-grafana-oidc.yaml
      - blueprints/11-argocd-oidc.yaml
      - blueprints/12-traefik-oidc.yaml
      - blueprints/20-forward-auth.yaml
      - blueprints/30-outpost.yaml
    options:
      # Disable hash suffix so Helm values can reference by name
      disableNameSuffixHash: true
